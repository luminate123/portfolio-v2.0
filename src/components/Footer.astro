---
const currentYear = new Date().getFullYear();
---

<footer id="contact" class="section footer">
    <div class="wave-decoration">
        <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
            <path
                d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z"
                fill="currentColor"></path>
        </svg>
    </div>
    <div class="container">
        <div class="footer-content">
            <div class="footer-main animate-on-scroll">
                <h2>¿Listo para trabajar juntos?</h2>
                <p>
                    Estoy abierto a nuevas oportunidades y colaboraciones.
                    ¡Hablemos!
                </p>
                <form
                    class="contact-form"
                    action="https://formspree.io/f/mbdarzre"
                    method="POST"
                >
                    <div class="form-row">
                        <div class="form-field">
                            <label for="contact-name">Nombre</label>
                            <input
                                id="contact-name"
                                name="Nombre"
                                type="text"
                                placeholder="Tu nombre"
                                required
                            />
                        </div>
                        <div class="form-field">
                            <label for="contact-email">Correo</label>
                            <input
                                id="contact-email"
                                name="Correo"
                                type="email"
                                placeholder="tu@email.com"
                                required
                            />
                        </div>
                    </div>
                    <div class="form-field">
                        <label for="contact-message">Mensaje</label>
                        <textarea
                            id="contact-message"
                            name="Mensaje"
                            rows="4"
                            placeholder="Cuéntame sobre tu proyecto"
                            required></textarea>
                    </div>
                    <button type="submit" class="btn-submit">
                        Enviar mensaje
                    </button>
                </form>
            </div>
        </div>
        <div class="footer-bottom animate-on-scroll delay-200">
            <p>
                &copy; {currentYear} Sebastian Senmache. Todos los derechos reservados.
            </p>
            <p class="built-with">
                Construido con <span class="heart">❤</span> usando Astro
            </p>
        </div>
    </div>
    <button class="back-to-top" aria-label="Volver arriba">
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            ><polyline points="18 15 12 9 6 15"></polyline></svg
        >
    </button>
</footer>

<div class="toast" role="status" aria-live="polite">
    <div class="toast-content">
        <span class="toast-title">¡Mensaje enviado!</span>
        <span class="toast-text">Gracias, te responderé lo antes posible.</span>
    </div>
    <button class="toast-close" aria-label="Cerrar notificación">×</button>
</div>

<script>
    // Back to top button
    const backToTopBtn = document.querySelector(".back-to-top");
    const toast = document.querySelector(".toast");
    const toastClose = document.querySelector(".toast-close");
    const contactForm = document.querySelector(".contact-form");

    window.addEventListener("scroll", () => {
        if (window.scrollY > 500) {
            backToTopBtn?.classList.add("visible");
        } else {
            backToTopBtn?.classList.remove("visible");
        }
    });

    backToTopBtn?.addEventListener("click", () => {
        window.scrollTo({
            top: 0,
            behavior: "smooth",
        });
    });

    const showToast = () => {
        toast?.classList.add("visible");
        window.setTimeout(() => toast?.classList.remove("visible"), 5000);
    };

    toastClose?.addEventListener("click", () => {
        toast?.classList.remove("visible");
    });

    contactForm?.addEventListener("submit", async (event) => {
        event.preventDefault();
        const form = event.currentTarget as HTMLFormElement;
        const formData = new FormData(form);

        try {
            const response = await fetch(form.action, {
                method: "POST",
                headers: {
                    Accept: "application/json",
                },
                body: formData,
            });

            if (response.ok) {
                form.reset();
                showToast();
            }
        } catch (error) {
            // Silently fail for now
        }
    });
</script>

<style>
    .footer {
        min-height: 60vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        background: transparent;
        padding: 4rem 0 2rem;
        margin: 0;
        border: none;
        position: relative;
        overflow: hidden;
    }

    /* Wave Decoration */
    .wave-decoration {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 80px;
        color: rgba(59, 130, 246, 0.1);
        transform: translateY(-1px);
    }

    .wave-decoration svg {
        width: 100%;
        height: 100%;
        display: block;
    }

    .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        margin-bottom: 4rem;
        position: relative;
        z-index: 1;
    }

    .footer-main h2 {
        font-size: var(--text-5xl);
        margin-bottom: 1.5rem;
        background: linear-gradient(
            135deg,
            var(--color-primary),
            var(--color-accent)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: var(--font-bold);
        letter-spacing: -0.02em;
    }

    .footer-main p {
        font-size: var(--text-xl);
        font-weight: var(--font-normal);
        color: var(--color-muted);
        margin-bottom: 2rem;
    }

    .contact-form {
        margin-top: 2rem;
        width: min(720px, 100%);
        display: flex;
        flex-direction: column;
        gap: 1.2rem;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    .form-field {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        text-align: left;
    }

    .form-field label {
        font-size: var(--text-sm);
        color: var(--color-muted);
        font-weight: var(--font-medium);
    }

    .form-field input,
    .form-field textarea {
        width: 100%;
        padding: 0.9rem 1rem;
        border-radius: 0.6rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(255, 255, 255, 0.04);
        color: var(--color-text);
        font-size: var(--text-base);
        transition:
            border-color 0.3s ease,
            box-shadow 0.3s ease,
            background 0.3s ease;
        outline: none;
    }

    .form-field textarea {
        resize: vertical;
        min-height: 140px;
    }

    .form-field input:focus,
    .form-field textarea:focus {
        border-color: rgba(59, 130, 246, 0.6);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        background: rgba(255, 255, 255, 0.06);
    }

    .btn-submit {
        align-self: center;
        padding: 0.9rem 2.4rem;
        border-radius: 0.6rem;
        border: none;
        font-weight: var(--font-semibold);
        font-size: var(--text-base);
        color: white;
        background: linear-gradient(
            135deg,
            var(--color-primary),
            var(--color-accent)
        );
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        cursor: pointer;
        transition:
            transform 0.3s ease,
            box-shadow 0.3s ease;
    }

    .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 25px rgba(59, 130, 246, 0.4);
    }

    .toast {
        position: fixed;
        right: 2rem;
        bottom: 2rem;
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(59, 130, 246, 0.4);
        border-radius: 0.9rem;
        padding: 1rem 1.25rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: 0 16px 30px rgba(0, 0, 0, 0.35);
        opacity: 0;
        transform: translateY(20px);
        pointer-events: none;
        transition: opacity 0.3s ease, transform 0.3s ease;
        z-index: 120;
        max-width: 320px;
    }

    .toast.visible {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
    }

    .toast-content {
        display: flex;
        flex-direction: column;
        gap: 0.2rem;
        color: var(--color-text);
    }

    .toast-title {
        font-weight: var(--font-semibold);
        font-size: var(--text-base);
    }

    .toast-text {
        font-size: var(--text-sm);
        color: var(--color-muted);
    }

    .toast-close {
        background: transparent;
        border: none;
        color: var(--color-muted);
        font-size: 1.25rem;
        cursor: pointer;
        line-height: 1;
    }

    .footer-links {
        margin-top: 3rem;
    }

    .social-links {
        display: flex;
        gap: 1.5rem;
        justify-content: center;
    }

    .social-icon {
        width: 56px;
        height: 56px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        color: var(--color-muted);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative;
        overflow: hidden;
    }

    .social-icon::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
            135deg,
            var(--color-primary),
            var(--color-accent)
        );
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 50%;
    }

    .social-icon svg {
        position: relative;
        z-index: 1;
        transition: transform 0.3s ease;
    }

    .social-icon:hover {
        border-color: transparent;
        transform: translateY(-5px) scale(1.1);
        box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
    }

    .social-icon:hover::before {
        opacity: 1;
    }

    .social-icon:hover svg {
        color: white;
        transform: scale(1.1);
    }

    .footer-bottom {
        text-align: center;
        padding-top: 2rem;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        position: relative;
        z-index: 1;
    }

    .footer-bottom p {
        font-size: var(--text-sm);
        font-weight: var(--font-normal);
        color: var(--color-muted);
        margin: 0.5rem 0;
    }

    .built-with {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.3rem;
    }

    .heart {
        color: #f5576c;
        animation: heartbeat 1.5s ease-in-out infinite;
    }

    @keyframes heartbeat {
        0%,
        100% {
            transform: scale(1);
        }
        10%,
        30% {
            transform: scale(1.1);
        }
        20%,
        40% {
            transform: scale(1);
        }
    }

    /* Back to Top Button */
    .back-to-top {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 50px;
        height: 50px;
        background: linear-gradient(
            135deg,
            var(--color-primary),
            var(--color-accent)
        );
        border: none;
        border-radius: 50%;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transform: translateY(100px);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        z-index: 99;
        box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
    }

    .back-to-top.visible {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .back-to-top:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(59, 130, 246, 0.6);
    }

    .back-to-top svg {
        animation: bounceUp 1.5s ease-in-out infinite;
    }

    @keyframes bounceUp {
        0%,
        100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-3px);
        }
    }

    @media (max-width: 768px) {
        .footer-content {
            flex-direction: column;
            gap: 3rem;
            text-align: center;
        }

        .footer-main h2 {
            font-size: 2.5rem;
        }

        .footer-main p {
            font-size: 1rem;
        }

        .form-row {
            grid-template-columns: 1fr;
        }

        .btn-submit {
            width: 100%;
        }

        .social-links {
            flex-wrap: wrap;
        }

        .social-icon {
            width: 48px;
            height: 48px;
        }

        .back-to-top {
            bottom: 1.5rem;
            right: 1.5rem;
            width: 45px;
            height: 45px;
        }

        .toast {
            right: 1rem;
            left: 1rem;
            bottom: 1rem;
            max-width: none;
        }
    }
</style>
